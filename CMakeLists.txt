PROJECT(pv_opensg_plugin)

CMAKE_MINIMUM_REQUIRED(VERSION 2.8)
SET(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}")
FIND_PACKAGE(ParaView REQUIRED)
FIND_PACKAGE(OpenSG COMPONENTS OSGBase OSGSystem REQUIRED)
INCLUDE(${PARAVIEW_USE_FILE})


# Initing and exiting of OpenSG
QT4_WRAP_CPP(MOC_SRCS pqOsgStarter.h)
ADD_PARAVIEW_AUTO_START(IFACES IFACE_SRCS CLASS_NAME pqOsgStarter
                        STARTUP onStartup
                        SHUTDOWN onShutdown)

ADD_PARAVIEW_PLUGIN(OpenSG_Exporter "1.0"
	GUI_INTERFACES ${IFACES}
	SERVER_MANAGER_XML OpenSGExporter.xml
	SERVER_MANAGER_SOURCES vtkOpenSGExporter.cxx
	SERVER_SOURCES vtkOSGConverter.cpp
	SOURCES pqOsgStarter.cxx ${MOC_SRCS} ${IFACE_SRCS}
	)

USE_OPENSG(OpenSG_Exporter)

STRING(REPLACE ".lib" ".dll" OpenSG_OSGBASE_LIBRARY_DLL ${OpenSG_OSGBASE_LIBRARY})
STRING(REPLACE ".lib" ".dll" OpenSG_OSGSYSTEM_LIBRARY_DLL ${OpenSG_OSGSYSTEM_LIBRARY})

IF(WIN32)
	INSTALL(TARGETS OpenSG_Exporter RUNTIME DESTINATION ${ParaView_DIR}/bin)
	INSTALL(FILES ${OpenSG_OSGBASE_LIBRARY_DLL} ${OpenSG_OSGSYSTEM_LIBRARY_DLL} DESTINATION ${ParaView_DIR}/bin)
ENDIF() # WIN32
